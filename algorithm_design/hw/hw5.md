## 算法设计与分析 HW 5

>李宇哲 SA25011049

### T1

>ch35-P39(EX3.9)
>
>若将环划分为长度为j(j是2的方幂)的连续片断，则所有这些片断是序等价的(Ex3.9)。

令 $n=2^k$，编号集合为

$V=\{01,2,...,n-1\}$

定义：

- $rev_k\{x\}$：表示把x的k位二进制反转
- 反转环：$R_n^{rev} = (rev_k(0),rev_k(1),...,rev_k(n-1))$

待证明：

取长度 $j=2^r$ 的连续子片段，所有这些判断的内部相对顺序一致。

写出整数i的k位二进制表示： $i = (a_{k-1}a_{k-2}...a_1a_0)_2$

于是可以把i分成两部分，高 k-r位和低r位

$high(i) = (a_{k-1}...a_r)_2$ ，$low(i)=(a_{r-1}...a_0)_2$

有 $i = high(i)\cdot 2^r + low(i)$

反转k位后，$rev_k(i) = rev_r(low(i))\cdot2^{k-r} + rev_{k-r}(high(i))$

取连续j=$2^r$个i，这些i里high(i)相同，low(i)取遍0,....,$2^r-1$

于是对于每段长度j对应一个固定high部分的集合$S_g = \{i|high(i)=g\}$

在i在判断 $S_g$内部按low递增排列，得到 $R_n^{rev}$中该段的顺序，因此该片段集合是

$B_g = [rev_r(0), rev_r(1), ... ,rev_r(2^r-1)]整体偏移 rev_{k-r}(g)$

不同的 g ，只有加上常数 $rev_{k−r}(g)$ 不同，而内部排列方式由 $[rev_r(0...2^r-1)]$决定，对所有g相同

序等性只关心元素内部的相对大小关系，即一个序列是否可以通过单调平移/映射变成一个序列，所以两者内部相对顺序完全一致，这是在整体上加了不同常数。

所以得证